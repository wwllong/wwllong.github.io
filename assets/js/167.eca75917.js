(window.webpackJsonp=window.webpackJsonp||[]).push([[167],{815:function(s,a,t){"use strict";t.r(a);var n=t(58),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"gc日志分析"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#gc日志分析"}},[s._v("#")]),s._v(" GC日志分析")]),s._v(" "),t("p",[s._v("通过阅读GC日志，我们可以了解Java虚拟机内存分配与回收策略。")]),s._v(" "),t("h2",{attrs:{id:"gc分类"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#gc分类"}},[s._v("#")]),s._v(" GC分类")]),s._v(" "),t("p",[s._v("针对HotSpot VM的实现，它里面的GC按照回收区域又分为两大种类型：一种是部分收集（Partial GC），一种是整堆收集（Full GC）")]),s._v(" "),t("ul",[t("li",[s._v("部分收集（Partial GC）：不是完整收集整个Java堆的垃圾收集。其中又分为：\n"),t("ul",[t("li",[s._v("新生代收集（Minor GC / Young GC）：只是新生代（Eden / S0, S1）的垃圾收集")]),s._v(" "),t("li",[s._v("老年代收集（Major GC / Old GC）：只是老年代的垃圾收集。目前，只有CMS GC会有单独收集老年代的行为。注意，很多时候Major GC会和Full GC混淆使用，需要具体分辨是老年代回收还是整堆回收。")])])]),s._v(" "),t("li",[s._v("混合收集（Mixed GC）：收集整个新生代以及部分老年代的垃圾收集。目前，只有G1 GC会有这种行为")]),s._v(" "),t("li",[s._v("整堆收集（Full GC）：收集整个java堆和方法区的垃圾收集。")])]),s._v(" "),t("h2",{attrs:{id:"gc日志分类"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#gc日志分类"}},[s._v("#")]),s._v(" GC日志分类")]),s._v(" "),t("p",[s._v("GC日志大概可以分成两类：MinorGC（或Young GC或YGC）日志和Full GC日志。")]),s._v(" "),t("h2",{attrs:{id:"gc日志分析工具"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#gc日志分析工具"}},[s._v("#")]),s._v(" GC日志分析工具")]),s._v(" "),t("p",[s._v("可以用一些常用的工具分析保存下来的GC日志：GCViewer、GCEasy、")]),s._v(" "),t("p",[t("strong",[t("a",{attrs:{href:"https://gceasy.io/",target:"_blank",rel:"noopener noreferrer"}},[s._v("GCEasy"),t("OutboundLink")],1)]),s._v("：GCEasy是一款在线的GC日志分析器，可以通过GC日志分析进行内存泄露检测、GC暂停原因分析、JVM配置建议优化等功能，大多数功能是免费的。")]),s._v(" "),t("p",[t("strong",[t("a",{attrs:{href:"https://github.com/chewiebug/GCViewer",target:"_blank",rel:"noopener noreferrer"}},[s._v("GCViewer"),t("OutboundLink")],1)]),s._v("：GCViewer是一款离线的GC日志分析器，用于可视化Java VM选项 -verbose:gc 和 .NET生成的数据 -Xloggc:<file>。还可以计算与垃圾回收相关的性能指标（吞吐量、累积的暂停、最长的暂停等）。当通过更改世代大小或设置初始堆大小来调整特定应用程序的垃圾回收时，此功能非常有用。")]),s._v(" "),t("ul",[t("li",[s._v("官网上没有下载的地方，需要自己从SVN上拉下来编译")]),s._v(" "),t("li",[s._v("不过这个工具似乎没怎么维护了，存在不少bug")])]),s._v(" "),t("p",[s._v("还有一些其他的分析工具，如GCHisto、GCLogViewer、Hpjmeter、garbagecat等等，这里不一一列举。")]),s._v(" "),t("h2",{attrs:{id:"常用日志jvm参数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#常用日志jvm参数"}},[s._v("#")]),s._v(" 常用日志JVM参数")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("-XX:+PrintGC")]),s._v(": 输出GC日志。类似："),t("code",[s._v("java -verbose:gc")])]),s._v(" "),t("li",[t("code",[s._v("-XX:+PrintGCDetails")]),s._v(" : 输出GC的详细日志")]),s._v(" "),t("li",[t("code",[s._v("-XX:+PrintGCTimestamps")]),s._v(" : 输出GC的时间戳（以基准时间的形式）")]),s._v(" "),t("li",[t("code",[s._v("-XX:+PrintGCDatestamps")]),s._v(" : 输出GcC的时间戳（以日期的形式，如2013-05-04T21：53：59.234+0800）")]),s._v(" "),t("li",[t("code",[s._v("-XX:+PrintHeapAtGC")]),s._v(": 在进行GC的前后打印出堆的信息")]),s._v(" "),t("li",[t("code",[s._v("-Xloggc:../logs/gc.log")]),s._v(": 日志文件的输出路径")])]),s._v(" "),t("h2",{attrs:{id:"xx-printgc"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#xx-printgc"}},[s._v("#")]),s._v(" -XX:+PrintGC")]),s._v(" "),t("p",[s._v("类似："),t("code",[s._v("java -verbose:gc")]),s._v("，这个只会显示总的GC堆的变化，如下：")]),s._v(" "),t("div",{staticClass:"language-java extra-class"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("GC "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Allocation")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Failure")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80832")]),s._v("K"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("19298K")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("227840")]),s._v("K"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0084018")]),s._v(" secs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("GC "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Metadata")]),s._v(" GC "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Threshold")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("109499")]),s._v("K"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("21465K")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("228352")]),s._v("K"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0184066")]),s._v(" secs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Full")]),s._v(" GC "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Metadata")]),s._v(" GC "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Threshold")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("21465")]),s._v("K"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("16716K")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("201728")]),s._v("K"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0619261")]),s._v(" secs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])])]),t("p",[s._v("参数解析：")]),s._v(" "),t("div",{staticClass:"language-java extra-class"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[s._v("GC、"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Full")]),s._v(" GC：GC的类型，GC只在新生代上进行，"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Full")]),s._v(" GC包括永生代，新生代，老年代。\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Allocation")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Failure")]),s._v("：GC发生的原因。\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80832")]),s._v("K"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("19298")]),s._v("K：堆在GC前的大小和GC后的大小。\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("228840")]),s._v("k：现在的堆大小。\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0084018")]),s._v(" secs：GC持续的时间。\n")])])]),t("h2",{attrs:{id:"xx-printgcdetails"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#xx-printgcdetails"}},[s._v("#")]),s._v(" -XX:+PrintGCDetails")]),s._v(" "),t("p",[s._v("输出GC的详细日志：")]),s._v(" "),t("div",{staticClass:"language-java extra-class"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("GC "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Allocation")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Failure")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PSYoungGen")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("70640")]),s._v("K"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("10116K")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("141312")]),s._v("K"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80541")]),s._v("K"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("20017K")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("227328")]),s._v("K"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0172573")]),s._v(" secs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Times")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("user"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.03")]),s._v(" sys"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("real"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.02")]),s._v(" secs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("GC "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Metadata")]),s._v(" GC "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Threshold")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PSYoungGen")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("98859")]),s._v("K"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("8154K")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("142336")]),s._v("K"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("108760")]),s._v("K"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("21261K")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("228352")]),s._v("K"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0151573")]),s._v(" secs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Times")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("user"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),s._v(" sys"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.01")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("real"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.02")]),s._v(" secs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Full")]),s._v(" GC "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Metadata")]),s._v(" GC "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Threshold")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PSYoungGen")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8154")]),s._v("K"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("0K")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("142336")]),s._v("K"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ParOldGen")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("13107")]),s._v("K"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("16809K")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("62464")]),s._v("K"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("21261")]),s._v("K"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("16809K")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("204800")]),s._v("K"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Metaspace")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("20599")]),s._v("K"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("20599K")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1067008")]),s._v("K"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0639732")]),s._v(" secs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Times")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("user"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.14")]),s._v(" sys"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("real"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.06")]),s._v(" secs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])])]),t("p",[s._v("参数解析：")]),s._v(" "),t("div",{staticClass:"language-java extra-class"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[s._v("GC，"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Full")]),s._v(" FC：同样是GC的类型\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Allocation")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Failure")]),s._v("：GC原因\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PSYoungGen")]),s._v("：使用了"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Parallel")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Scavenge")]),s._v("并行垃圾收集器的新生代GC前后大小的变化\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ParOldGen")]),s._v("：使用了"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Parallel")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Old")]),s._v("并行垃圾收集器的老年代GC前后大小的变化\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Metaspace")]),s._v("： 元数据区GC前后大小的变化，JDK1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("中引入了元数据区以替代永久代\nxxx secs：指GC花费的时间\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Times")]),s._v("：user：指的是垃圾收集器花费的所有CPU时间，sys：花费在等待系统调用或系统事件的时间，real：GC从开始到结束的时间，包括其他进程占用时间片的实际时间。\n")])])]),t("h2",{attrs:{id:"xx-printgctimestamps-xx-printgcdatestamps"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#xx-printgctimestamps-xx-printgcdatestamps"}},[s._v("#")]),s._v(" -XX:+PrintGCTimestamps & -XX:+PrintGCDatestamps")]),s._v(" "),t("p",[s._v("显示GC的时间信息，例如打开如下的日志配置：")]),s._v(" "),t("div",{staticClass:"language-java extra-class"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("verbose"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("gc "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("XX"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PrintGCDetails")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("XX"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PrintGCTimestamps")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("XX"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PrintGCDatestamps")]),s._v("\n")])])]),t("p",[s._v("输出信息如下：")]),s._v(" "),t("div",{staticClass:"language-java extra-class"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2019")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("09")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("24")]),s._v("T22"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("24.518")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0800")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3.287")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("GC "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Allocation")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Failure")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PSYoungGen")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("136162")]),s._v("K"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("5113K")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("136192")]),s._v("K"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("141425")]),s._v("K"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("17632K")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("222208")]),s._v("K"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0248249")]),s._v(" secs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Times")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("user"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.05")]),s._v(" sys"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("real"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.03")]),s._v(" secs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2019")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("09")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("24")]),s._v("T22"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("25.559")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0800")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4.329")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("GC "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Metadata")]),s._v(" GC "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Threshold")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PSYoungGen")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("97578")]),s._v("K"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("10068K")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("274944")]),s._v("K"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("110096")]),s._v("K"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("22658K")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("360960")]),s._v("K"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0094071")]),s._v(" secs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Times")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" user"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),s._v(" sys"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("real"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.01")]),s._v(" secs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2019")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("09")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("24")]),s._v("T22"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("25.569")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0800")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4.338")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Full")]),s._v(" GC "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Metadata")]),s._v(" GC "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Threshold")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PSYoungGen")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10068")]),s._v("K"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("0K")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("274944")]),s._v("K"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ParoldGen")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("12590")]),s._v("K"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("13564K")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("56320")]),s._v("K"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("22658")]),s._v("K"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("13564K")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("331264")]),s._v("K"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Metaspace")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("20590")]),s._v("K"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("->")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("20590K")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1067008")]),s._v("K"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0494875")]),s._v(" secs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Times")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" user"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.17")]),s._v(" sys"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.02")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("real"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.05")]),s._v(" secs"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])])]),t("p",[s._v("说明：带上了日期。")]),s._v(" "),t("h2",{attrs:{id:"xloggc"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#xloggc"}},[s._v("#")]),s._v(" -Xloggc")]),s._v(" "),t("p",[s._v("如果想把GC日志存到文件的话，是下面的参数：")]),s._v(" "),t("div",{staticClass:"language-java extra-class"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Xloggc")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("path"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("to")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("gc"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("log\n")])])]),t("h2",{attrs:{id:"gc日志结构剖析"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#gc日志结构剖析"}},[s._v("#")]),s._v(" GC日志结构剖析")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("[GC")]),s._v("和"),t("code",[s._v("[Full GC")]),s._v("说明了这次垃圾收集的停顿类型，如果有"),t("code",[s._v("Full")]),s._v('则说明GC发生了"Stop The World"')])]),s._v(" "),t("h3",{attrs:{id:"透过日志看垃圾收集器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#透过日志看垃圾收集器"}},[s._v("#")]),s._v(" 透过日志看垃圾收集器")]),s._v(" "),t("ul",[t("li",[s._v("使用"),t("code",[s._v("Serial")]),s._v("收集器在新生代的名字是"),t("code",[s._v("Default New Generation")]),s._v("，因此显示的是"),t("code",[s._v("[DefNew")])]),s._v(" "),t("li",[s._v("使用"),t("code",[s._v("ParNew")]),s._v("收集器在新生代的名字会变成"),t("code",[s._v("[ParNew")]),s._v("，意思是"),t("code",[s._v("Parallel New Generation")])]),s._v(" "),t("li",[s._v("使用"),t("code",[s._v("Parallel Scavenge")]),s._v("收集器在新生代的名字是"),t("code",[s._v("[PSYoungGen")])]),s._v(" "),t("li",[s._v("使用"),t("code",[s._v("Parallel Old")]),s._v("收集器收集器在老年代显示"),t("code",[s._v('[ParoldGen"')])]),s._v(" "),t("li",[s._v("使用"),t("code",[s._v("G1")]),s._v("收集器的话，会显示为"),t("code",[s._v("garbage-first heap")])])]),s._v(" "),t("h3",{attrs:{id:"透过日志看gc原因"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#透过日志看gc原因"}},[s._v("#")]),s._v(" 透过日志看GC原因")]),s._v(" "),t("ul",[t("li",[s._v("Allocation Failure：表明本次引起GC的原因是因为在年轻代中没有足够的空间能够存储新的数据了。")]),s._v(" "),t("li",[s._v("Metadata GCThreshold：Metaspace区不够用了")]),s._v(" "),t("li",[s._v("FErgonomics：JVM自适应调整导致的GC")]),s._v(" "),t("li",[s._v("System：调用了System.gc()方法")])]),s._v(" "),t("h3",{attrs:{id:"透过日志看gc前后情况"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#透过日志看gc前后情况"}},[s._v("#")]),s._v(" 透过日志看GC前后情况")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("GC日志格式的规律一般都是：GC前内存占用-＞GC后内存占用（该区域内存总大小）")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("PSYoungGen：5986K-"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("696K"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("8704K"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("  5986K-"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("704K"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("9216K"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n- 中括号内：GC回收前年轻代大小，回收后大小，（年轻代总大小）\n- 括号外：GC回收前年轻代和老年代大小，回收后大小，（年轻代和老年代总大小） \n")])])])])]),s._v(" "),t("p",[s._v("注意：Minor GC堆内存总容量 = 9/10 年轻代 + 老年代。原因是Survivor区只计算from部分，而JVM默认年轻代中Eden区和Survivor区的比例关系，Eden:S0:S1=8:1:1。")]),s._v(" "),t("h3",{attrs:{id:"透过日志看gc时间"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#透过日志看gc时间"}},[s._v("#")]),s._v(" 透过日志看GC时间")]),s._v(" "),t("p",[s._v("GC日志中有三个时间：user，sys和real")]),s._v(" "),t("ul",[t("li",[s._v("user：进程执行用户态代码（核心之外）所使用的时间。这是执行此进程所使用的实际CPU 时间，其他进程和此进程阻塞的时间并不包括在内。在垃圾收集的情况下，表示GC线程执行所使用的 CPU 总时间。")]),s._v(" "),t("li",[s._v("sys：进程在内核态消耗的 CPU 时间，即在内核执行系统调用或等待系统事件所使用的CPU 时间")]),s._v(" "),t("li",[s._v("real：程序从开始到结束所用的时钟时间。这个时间包括其他进程使用的时间片和进程阻塞的时间（比如等待 I/O 完成）。对于并行gc，这个数字应该接近（用户时间＋系统时间）除以垃圾收集器使用的线程数。")])]),s._v(" "),t("p",[s._v("由于多核的原因，一般的GC事件中，real time是小于sys time＋user time的，因为一般是多个线程并发的去做GC，所以real time是要小于sys＋user time的。如果real＞sys＋user的话，则你的应用可能存在下列问题：IO负载非常重或CPU不够用。")]),s._v(" "),t("p",[s._v("简单来说就是，user代表用户态回收耗时，sys内核态回收耗时，rea实际耗时。由于多核的原因，时间总和可能会超过real时间。")]),s._v(" "),t("p",[s._v("日志分析例子：")]),s._v(" "),t("div",{staticClass:"language-java extra-class"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Heap")]),s._v("（堆）\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PSYoungGen")]),s._v("（"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Parallel")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Scavenge")]),s._v("收集器新生代）total "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9216")]),s._v("K，used "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("6234")]),s._v("K "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x00000000ff600000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x0000000100000000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x0000000100000000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\neden space（堆中的"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Eden")]),s._v("区默认占比是"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),s._v("）"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8192")]),s._v("K，"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("768")]),s._v(" used "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x00000000ff600000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x00000000ffc16b08")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x00000000ffe00000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nfrom space（堆中的"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Survivor")]),s._v("，这里是"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("From")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Survivor")]),s._v("区默认占比是"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("）"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1024")]),s._v("K， "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v(" used "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x00000000fff00000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x00000000fff00000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x0000000100000000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("to")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("space")]),s._v("（堆中的"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Survivor")]),s._v("，这里是"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("to")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Survivor")]),s._v("区默认占比是"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("，需要先了解一下堆的分配策略）"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1024")]),s._v("K"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("%")]),s._v(" used "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x00000000ffe00000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x00000000ffe00000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x00000000fff00000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                                                                         \n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("ParOldGen")]),s._v("（老年代总大小和使用大小）total "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10240")]),s._v("K， used "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("7001")]),s._v("K ［"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x00000000fec00000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x00000000ff600000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x00000000ff600000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nobject space（显示个使用百分比）"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10240")]),s._v("K，"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("688")]),s._v(" used "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x00000000fec00000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x00000000ff2d6630")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x00000000ff600000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PSPermGen")]),s._v("（永久代总大小和使用大小）total "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("21504")]),s._v("K， used "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4949")]),s._v("K "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x00000000f9a00000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x00000000faf00000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x00000000fec00000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nobject space（显示个使用百分比，自己能算出来）"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("21504")]),s._v("K， "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("238")]),s._v(" used "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x00000000f9a00000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x00000000f9ed55e0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0x00000000faf00000")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])])]),t("h2",{attrs:{id:"minor-gc日志图解"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#minor-gc日志图解"}},[s._v("#")]),s._v(" Minor GC日志图解")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://qiniu.wenwl.site/notes/jvm/gc_log_1.png",alt:"gc_log_1"}})]),s._v(" "),t("h2",{attrs:{id:"full-gc日志图解"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#full-gc日志图解"}},[s._v("#")]),s._v(" Full GC日志图解")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://qiniu.wenwl.site/notes/jvm/gc_log_2.png",alt:"gc_log_2"}})]),s._v(" "),t("p",[s._v("举例：")]),s._v(" "),t("div",{staticClass:"language-java extra-class"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("private")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("final")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v(" _1MB "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1024")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1024")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("testAllocation")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("byte")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" allocation1"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" allocation2"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" allocation3"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" allocation4"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    allocation1 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("byte")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("_1MB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    allocation2 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("byte")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("_1MB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    allocation3 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("byte")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("_1MB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n    allocation4 "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("byte")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v("_1MB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" args"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("testAllocation")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),t("p",[s._v("设置JVM参数：")]),s._v(" "),t("div",{staticClass:"language-java extra-class"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Xms10m")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Xmx10m")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("XX"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("+")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("PrintGCDetails")]),s._v("\n")])])]),t("p",[s._v("图示：")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://qiniu.wenwl.site/notes/jvm/gc_log_3.png",alt:"gc_log_3"}})]),s._v(" "),t("p",[t("img",{attrs:{src:"https://qiniu.wenwl.site/notes/jvm/gc_log_4.png",alt:"gc_log_4"}})])])}),[],!1,null,null,null);a.default=e.exports}}]);