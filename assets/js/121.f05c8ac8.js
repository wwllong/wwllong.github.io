(window.webpackJsonp=window.webpackJsonp||[]).push([[121],{755:function(s,t,a){"use strict";a.r(t);var e=a(58),n=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"docker-构建-mysql"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#docker-构建-mysql"}},[s._v("#")]),s._v(" Docker 构建 MySQL")]),s._v(" "),a("h2",{attrs:{id:"查找-mysql-镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查找-mysql-镜像"}},[s._v("#")]),s._v(" 查找 MySQL 镜像")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("wenwl@lubuntu:~$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" search mysql\nNAME                              DESCRIPTION                                     STARS     OFFICIAL   AUTOMATED\nmysql                             MySQL is a widely used, open-source relation…   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("11096")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("OK"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("       \nmariadb                           MariaDB Server is a high performing "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("open")]),s._v(" sou…   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4203")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("OK"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("       \nmysql/mysql-server                Optimized MySQL Server Docker images. Create…   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("824")]),s._v("                  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("OK"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\ncentos/mysql-57-centos7           MySQL "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.7")]),s._v(" SQL database server                   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("88")]),s._v("                   \nmysql/mysql-cluster               Experimental MySQL Cluster Docker images. Cr…   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("88")]),s._v("                   \ncenturylink/mysql                 Image containing mysql. Optimized to be link…   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("59")]),s._v("                   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("OK"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\ndataback/mysql-backup             Back up mysql databases to"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(". anywhere"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("         "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("44")]),s._v("                   \ndeitch/mysql-backup               REPLACED"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" Please use http://hub.docker.com/r…   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("41")]),s._v("                   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("OK"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nprom/mysqld-exporter                                                              "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("39")]),s._v("                   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("OK"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\ntutum/mysql                       Base "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" image to run a MySQL database se…   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("35")]),s._v("                   \nlinuxserver/mysql                 A Mysql container, brought to you by LinuxSe…   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("30")]),s._v("                   \nschickling/mysql-backup-s3        Backup MySQL to S3 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("supports periodic backup…   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("29")]),s._v("                   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("OK"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nmysql/mysql-router                MySQL Router provides transparent routing be…   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),s._v("                   \ncentos/mysql-56-centos7           MySQL "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.6")]),s._v(" SQL database server                   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),s._v("                   \narey/mysql-client                 Run a MySQL client from a "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" container      "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("17")]),s._v("                   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("OK"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nfradelg/mysql-cron-backup         MySQL/MariaDB database backup using "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cron")]),s._v(" tas…   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v("                   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("OK"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nyloeffler/mysql-backup            This image runs mysqldump to backup data usi…   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("                    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("OK"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\ngenschsa/mysql-employees          MySQL Employee Sample Database                  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("                    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("OK"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nopenshift/mysql-55-centos7        DEPRECATED: A Centos7 based MySQL v5.5 image…   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("                    \ncytopia/mysql-5.5                 MySQL "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.5")]),s._v(" on CentOS "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("                           "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("                    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("OK"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\ndevilbox/mysql                    Retagged MySQL, MariaDB and PerconaDB offici…   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("                    \nansibleplaybookbundle/mysql-apb   An APB "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("which")]),s._v(" deploys RHSCL MySQL                "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("                    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("OK"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\njelastic/mysql                    An image of the MySQL database server mainta…   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("                    \nwiddpim/mysql-client              Dockerized MySQL Client "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("5.7")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" including Curl…   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("                    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("OK"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nmonasca/mysql-init                A minimal decoupled init container "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" mysql    "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("                 \n")])])]),a("h2",{attrs:{id:"拉取镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#拉取镜像"}},[s._v("#")]),s._v(" 拉取镜像")]),s._v(" "),a("p",[s._v("这里我们拉取官方的镜像")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("wenwl@lubuntu:~$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull mysql\nUsing default tag: latest\nlatest: Pulling from library/mysql\nb4d181a07f80: Pull complete \na462b60610f5: Pull complete \n578fafb77ab8: Pull complete \n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("524046006037")]),s._v(": Pull complete \nd0cbe54c8855: Pull complete \naa18e05cc46d: Pull complete \n32ca814c833f: Pull complete \n9ecc8abdb7f5: Pull complete \nad042b682e0f: Pull complete \n71d327c6bb78: Pull complete \n165d1d10a3fa: Pull complete \n2f40c47d0626: Pull complete \nDigest: sha256:52b8406e4c32b8cf0557f1b74517e14c5393aff5cf0384eff62d9e81f4985d4b\nStatus: Downloaded newer image "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" mysql:latest\ndocker.io/library/mysql:latest\n\n")])])]),a("p",[s._v("等待下载完成后，我们就可以在本地镜像列表里查到 REPOSITORY 为 mysql 的镜像")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("wenwl@lubuntu:~$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" images\nREPOSITORY    TAG       IMAGE ID       CREATED        SIZE\ntomcat        latest    36ef696ea43d   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" days ago     667MB\nmysql         latest    5c62e459e087   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" weeks ago    556MB\nhello-world   latest    d1165f221234   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" months ago   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(".3kB\n")])])]),a("h2",{attrs:{id:"运行容器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#运行容器"}},[s._v("#")]),s._v(" 运行容器")]),s._v(" "),a("p",[s._v("编写笔记时，mysql latest 的版本为 8.0.25，配置过程：")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 挂载外部配置和数据安装")]),s._v("\nwenwl@lubuntu:/usr/local/docker/mysql$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" conf.d\nwenwl@lubuntu:/usr/local/docker/mysql$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" data\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建配置文件")]),s._v("\nwenwl@lubuntu:/usr/local/docker/mysql$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("touch")]),s._v(" my.cnf\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 添加如下内容")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("mysqld"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("user")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mysql\ncharacter-set-server"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("utf8\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("default_authentication_plugin")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("mysql_native_password\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("secure_file_priv")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/var/lib/mysql\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("expire_logs_days")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("7")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("sql_mode")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("max_connections")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1000")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("lower_case_table_names")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("client"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\ndefault-character-set"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("utf8\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("mysql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\ndefault-character-set"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("utf8\n")])])]),a("p",[s._v("创建容器，守护态运行")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mysql latest 的版本为 8.0.25")]),s._v("\nwenwl@lubuntu:/usr/local/docker/mysql5.7$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -p "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),s._v(":3306 --name mysql "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" --restart"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("always --privileged"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" -v /usr/local/docker/mysql/data:/var/lib/mysql "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" -v /usr/local/docker/mysql/conf.d:/etc/mysql/conf.d "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" -v /usr/local/docker/mysql/my.cnf:/etc/mysql/my.cnf "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" -e "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MYSQL_ROOT_PASSWORD")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" -d mysql\n")])])]),a("p",[s._v("命令参数说明：")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("-p 3306:3306")]),s._v("：将容器的3306端口映射到主机的3306端口")]),s._v(" "),a("li",[a("code",[s._v("--restart=always")]),s._v("： 当Docker 重启时，容器会自动启动")]),s._v(" "),a("li",[a("code",[s._v("--privileged=true")]),s._v("：容器内的root拥有真正root权限，否则容器内root只是外部普通用户权限")]),s._v(" "),a("li",[a("code",[s._v("-v /usr/local/docker/mysql/data:/var/lib/mysql")]),s._v("：映射数据目录，将主机当前目录下的 data 目录挂载到容器的 /var/lib/mysql")]),s._v(" "),a("li",[a("code",[s._v("-v /usr/local/docker/mysql/conf.d:/etc/mysql/conf.d")]),s._v("：映射配置文件，将主机当前目录下的 conf .d 挂载到容器的 /etc/mysql/confi.d")]),s._v(" "),a("li",[a("code",[s._v("-e MYSQL\\_ROOT\\_PASSWORD=123456")]),s._v("：初始化root用户的密码")])]),s._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[s._v("提示")]),s._v(" "),a("p",[s._v("如果出现关于报错[Server] Failed to access directory for --secure-file-priv. Please make sure that directory exists and is accessible by MySQL Server. Supplied value : /var/lib/mysql-files。")]),s._v(" "),a("p",[s._v("是因为MYSQL新特性secure_file_priv对读写文件的影响，解决办法：")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("windows下：修改my.ini 在[mysqld]内加入secure_file_priv=/var/lib/mysql\nlinux下：修改my.cnf 在[mysqld]内加入secure_file_priv=/var/lib/mysql\n")])])])]),s._v(" "),a("p",[s._v("容器启动完成后，发现无法用客户端进行远程连接：")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("HY000"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1130")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" null,  message from server: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"Host '192.168.0.101' is not allowed to connect to this MySQL server\"")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n")])])]),a("p",[s._v("需要先进入容器交互，配置远程连接：")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("wenwl@lubuntu:/usr/local/docker/mysql$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" -it mysql "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("bash")]),s._v("\nroot@27a6365e7a9b:/"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mysql -u root -p")]),s._v("\nEnter password: \nERROR "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1045")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("28000")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(": Access denied "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" user "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),s._v("@"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'localhost'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("using password: YES"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nroot@27a6365e7a9b:/"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mysql -u root -p")]),s._v("\nEnter password: \nWelcome to the MySQL monitor.  Commands end with "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" or "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("g.\nYour MySQL connection "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("id")]),s._v(" is "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v("\nServer version: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8.0")]),s._v(".25 MySQL Community Server - GPL\n\nCopyright "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("c"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2000")]),s._v(", "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v(", Oracle and/or its affiliates.\n\nOracle is a registered trademark of Oracle Corporation and/or its\naffiliates. Other names may be trademarks of their respective\nowners.\n\nType "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'help;'")]),s._v(" or "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\\h'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" help. Type "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\\c'")]),s._v(" to "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("clear")]),s._v(" the current input statement.\n\nmysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" \n\n")])])]),a("p",[s._v("从上面的提示可知，在最开始创建容器的时候，初始化root用户密码的设置也没有生效，这时候密码默认为空，直接Enter即可。")]),s._v(" "),a("p",[s._v("接下来正式改密码和授权远程连接：")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("mysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" update user "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("host")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'%'")]),s._v(" where "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("user")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nQuery OK, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" row affected "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.04")]),s._v(" sec"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\nRows matched: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("  Changed: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("  Warnings: "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\nmysql"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" ALTER "),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("USER")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),s._v("@"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'%'")]),s._v(" IDENTIFIED WITH mysql_native_password BY "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'123456'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nQuery OK, "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" rows affected "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.04")]),s._v(" sec"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])])]),a("p",[s._v("这个时候就可以远程连接了。")]),s._v(" "),a("p",[s._v("附创建容器MySQL 5.7 版本命令：")]),s._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 5.7 版本")]),s._v("\nwenwl@lubuntu:/usr/local/docker/mysql5.7$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run -p "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),s._v(":3306 --name mysql "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" -v /usr/local/docker/mysql5.7/conf:/etc/mysql "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" -v /usr/local/docker/mysql5.7/logs:/var/log/mysql "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" -v /usr/local/docker/mysql5.7/data:/var/lib/mysql "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" -e "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("MYSQL_ROOT_PASSWORD")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" -d mysql:5.7\n")])])]),a("p",[s._v("查看容器启动情况")]),s._v(" "),a("div",{staticClass:"language-text extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v('wenwl@lubuntu:/usr/local/docker/mysql$ docker ps\nCONTAINER ID   IMAGE     COMMAND                  CREATED          STATUS          PORTS                                                  NAMES\n27a6365e7a9b   mysql     "docker-entrypoint.s…"   31 minutes ago   Up 31 minutes   0.0.0.0:3306->3306/tcp, :::3306->3306/tcp, 33060/tcp   mysql\n')])])]),a("p",[s._v("使用客户端工具连接 MySQL（略）")]),s._v(" "),a("h2",{attrs:{id:"参考"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[s._v("#")]),s._v(" 参考")]),s._v(" "),a("ol",[a("li",[a("a",{attrs:{href:"https://www.cnblogs.com/linjiqin/p/11465804.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("使用Docker安装mysql，挂载外部配置和数据"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://blog.csdn.net/xsj34567/article/details/80940238",target:"_blank",rel:"noopener noreferrer"}},[s._v("Docker 部署 Mysql8.0"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://www.jb51.net/article/163487.htm",target:"_blank",rel:"noopener noreferrer"}},[s._v("MySql8.0以上版本正确修改ROOT密码的方法"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://www.cnblogs.com/mzxiaoze/p/10413399.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("MYSQL8.0以上版本ROOT密码报错及修改"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://www.cnblogs.com/qianzf/p/7089197.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("mysql5.x如何修改root用户的密码"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);t.default=n.exports}}]);